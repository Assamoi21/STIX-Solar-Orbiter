<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>second API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>second</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">from tkinter import *
from tkinter.filedialog import askopenfilename
from astropy.io import fits
from astropy.table import Table
import plotting
import background


class SecondWindow:
    &#34;&#34;&#34;Class to create &#34;Select Input Window&#34; menu option in STIX.
    Rout: Go to top menu bars -&gt; File -&gt; Select Input.
    Initiates the parameters and widgets&#34;&#34;&#34;

    def __init__(self, root):
        &#34;&#34;&#34;Creating a new window for &#39;Select Input&#39; part, using the &#39;place&#39; geometry manager, allowing to explicitly
        set the position and dimensions of window. The place manager can be accessed through the place method.
        It can be applied to all standard widgets.&#34;&#34;&#34;
        self.top1 = Toplevel()
        self.top1.title(&#39;STIX Input Options&#39;)
        self.top1.geometry(&#34;1000x400&#34;)
        Label(self.top1, text=&#34;Select Input&#34;, fg=&#34;red&#34;, font=&#34;Helvetica 12 bold italic&#34;).place(relx=0.5, rely=0.01,
                                                                                               anchor=N)
        # Creates a window to inform user hdul is empty
        self.hdul = None
        self.root = root

        # &#39;Select input&#39; window should contain 2 frames:
        # 1) Widgets to load the data, read the content of .fits file extensions, etc;
        # 2) Widgets to  select the energy bands and time bands intervals, and plot.

        # ==================== First frame and additional widgets ====================

        # The name of the widget is in the &#39;text&#39; parameter
        self.frame1 = LabelFrame(self.top1, relief=RAISED, borderwidth=1)
        self.frame1.place(relx=0.5, rely=0.08, relheight=0.60, relwidth=0.9, anchor=N)

        self.name = None

        self.lblFilename = Label(self.frame1, text=&#34;Spectrum or Image File: &#34;)
        self.lblFilename.place(relx=0.01, rely=0.2)

        self.textFilename = Entry(self.frame1, width=20)
        self.textFilename.insert(0, &#34;No file chosen&#34;)
        self.textFilename.place(relx=0.2, rely=0.18, relheight=0.16, relwidth=0.57)

        self.browseButton = Button(self.frame1, text=&#39;Browse -&gt;&#39;, command=self.OpenFile)
        self.browseButton.place(relx=0.8, rely=0.186)

        self.chkBtEntireFile = Checkbutton(self.frame1, text=&#34;Entire file&#34;, command=self.checked)
        self.chkBtEntireFile.place(relx=0.03, rely=0.37)
        self.chkBtEntireFile.select()

        # Open file
        self.evt_data = Table()
        self.energies = Table()
        self.data_file = None
        self.time_summarize = Table()
        self.energie_summarize = Table()
        self.detector_summarize = Table()

        # Select Start data and End data for plotting if different of file&#39;s information(start-end)
        self.SetFromButton = Label(self.frame1, text=&#34;Set from -&gt; &#34;, state=DISABLED)
        self.SetFromButton.place(relx=0.1, rely=0.55)

        # Change Button to Label and insert the date data
        self.Times_range = []  # value for Times ranges

        self.start_date_var = StringVar()
        self.end_date_var = StringVar()
        self.start_time_plotting = StringVar()
        self.end_time_plotting = StringVar()

        self.StartButton = Label(self.frame1, text=&#34;Start&#34;, state=DISABLED)
        self.StartButton.place(relx=0.24, rely=0.55)

        self.textStart = Entry(self.frame1, textvariable=self.start_date_var, width=20)
        self.textStart.place(relx=0.31, rely=0.55, height=33, width=190)
        self.textStart[&#39;state&#39;] = &#39;disabled&#39;

        self.EndButton = Label(self.frame1, text=&#34;End&#34;, state=DISABLED)
        self.EndButton.place(relx=0.53, rely=0.55)

        self.textEnd = Entry(self.frame1, textvariable=self.end_date_var, width=20)
        self.textEnd.place(relx=0.59, rely=0.55, height=33, width=190)
        self.textEnd[&#39;state&#39;] = &#39;disabled&#39;

        # &#34;Summarize&#34; button. When clicked, creates a new window with the name &#34;SPEX::PREVIEW,
        # then gives information from self.hdul[1].header.
        self.SummarizeButton = Button(self.frame1, text=&#34;Summarize&#34;, command=self.Summarize)
        self.SummarizeButton.place(relx=0.45, rely=0.81, anchor=NE)

        # &#34;Show Header&#34; button. When clicked, gives the information from primary_header = hdulist[0].header.
        self.ShowHeaderButton = Button(self.frame1, text=&#34;Show Header&#34;, command=self.ShowHeader)
        self.ShowHeaderButton.place(relx=0.55, rely=0.81, anchor=NW)

        self.header_primary = None

        self.frame2 = LabelFrame(self.top1, relief=RAISED, borderwidth=2)

        # ==================== Second frame and plotting section ====================

        self.frame2.place(relx=0.5, rely=0.7, relheight=0.15, relwidth=0.9, anchor=N)

        # Plot Units for Rate, Counts, and Flux
        self.lblPlotUnits = Label(self.frame2, text=&#34;Plot Units: &#34;)
        self.lblPlotUnits.place(relx=0.013, rely=0.5, anchor=W)

        # Option menu for Rate, Counts, Flux
        self.Component_choices = (&#39;Rate&#39;, &#39;Counts&#39;, &#39;Flux&#39;)
        self.var = StringVar(self.frame1)
        self.var.set(self.Component_choices[0])
        self.selection = OptionMenu(self.frame2, self.var, *self.Component_choices)
        self.selection.place(relx=0.11, rely=0.5, anchor=W)

        self.PlotSpectrumButton = Button(self.frame2, text=&#34;Plot Spectrum&#34;,
                                         command=lambda: self.show_plot(&#34;spec&#34;))
        self.PlotSpectrumButton.place(relx=0.31, rely=0.5, anchor=W)

        self.PlotTimeProfileButton = Button(self.frame2, text=&#34;Plot Time Profile&#34;,
                                            command=lambda: self.show_plot(&#34;time&#34;))
        self.PlotTimeProfileButton.place(relx=0.457, rely=0.5, anchor=W)

        self.PlotSpectrogramButton = Button(self.frame2, text=&#34;Plot Spectrogram&#34;,
                                            command=lambda: self.show_plot(&#34;specgr&#34;))
        self.PlotSpectrogramButton.place(relx=0.62, rely=0.5, anchor=W)

        self.closeButton = Button(self.top1, text=&#34;Close&#34;, command=self.destroy)
        self.closeButton.place(relx=0.5, rely=0.9, anchor=N)

    # ============================ Main methods ============================

    def OpenFile(self):
        &#34;&#34;&#34;Reads the input data using Astropy library. It can be any extension. RHESSI .fits files are analysed.&#34;&#34;&#34;
        self.name = askopenfilename(initialdir=&#34;.&#34;,
                                    filetypes=((&#34;FITS files&#34;, &#34;*.fits&#34;), (&#34;All Files&#34;, &#34;*.*&#34;)),
                                    title=&#34;Please Select Spectrum or Image File&#34;)
        self.textFilename.delete(0, &#39;end&#39;)
        background.BackgroundWindow.fname = self.name

        if self.name:
            with fits.open(self.name) as hdul:
                self.hdul = hdul

                # Loads data to do the plot
                self.evt_data = Table(self.hdul[2].data)
                self.energies = Table(self.hdul[3].data)

                # Loads headers informations
                self.data_file = self.hdul[0].header[5]  # data type
                self.time_summarize = [self.hdul[2].data.time[-1], self.hdul[0].header[19],
                                       self.hdul[0].header[21]]  # time data
                self.energie_summarize = [self.hdul[3].header[4],
                                          max(min(self.energies[&#39;e_low&#39;]), min(self.energies[&#39;e_high&#39;])),
                                          min(max(self.energies[&#39;e_low&#39;]),
                                              max(self.energies[&#39;e_high&#39;]))]  # energies data
                self.detector_summarize = [&#34;No information found.&#34;]
                self.textFilename.insert(0, self.name)  # Displays the input file name in Entry box
        else:
            self.textFilename.insert(0, &#34;No file chosen&#34;)

    def Summarize(self):
        &#34;&#34;&#34;Creating a new window for Summarize button.
        Reads the information from Header and Data and display it in new window&#34;&#34;&#34;
        top = Toplevel()
        top.title(&#39;SPEX::PREVIEW&#39;)
        top.geometry(&#34;400x300&#34;)
        frameSummarize = LabelFrame(top, relief=RAISED, borderwidth=2)
        frameSummarize.pack(side=TOP, expand=True)

        txt = [&#34;\n\n\nSpectrum or Image File Summary&#34;,
               &#34;\nData Type: &#34;, self.data_file,
               &#34;\nFile name: &#34;, self.name,
               &#34;\n#Time Bins: &#34;, self.time_summarize[0], &#34;Time range: &#34;, self.time_summarize[1], &#39;to&#39;,
               self.time_summarize[2],
               &#34;\n#Energy Bins: &#34;, self.energie_summarize[0],
               &#34;Energy range: &#34;, self.energie_summarize[1], &#39;to&#39;, self.energie_summarize[2],
               &#34;\nDetectors Used: &#34;, self.detector_summarize[0],
               &#34;\nResponse Info: &#34;, self.name]
        liste = Text(frameSummarize)
        for t in txt:
            liste.insert(END, t)
        liste.pack()

    # FIXME: Text should be well-organized in the window &#39;SPEX::FITSHEADER&#39;
    def ShowHeader(self):
        &#34;&#34;&#34;Reads text information from header and display it in new window.&#34;&#34;&#34;
        self.header_primary = self.hdul[0].header
        top = Toplevel()
        top.title(&#39;SPEX::FITSHEADER&#39;)
        top.geometry(&#34;500x700&#34;)
        scrollbar1 = Scrollbar(top)
        scrollbar1.pack(side=RIGHT, fill=Y)
        header = Text(top, width=450, height=450)

        for i in range(len(self.header_primary.cards)):
            header.insert(INSERT, self.header_primary.cards[i])
            header.insert(INSERT, &#34;\n&#34;)

        header.insert(END, &#34;Fin&#34;)
        header.config(state=DISABLED)
        header.pack()
        scrollbar1.config(command=header.yview)

    def destroy(self):
        &#34;&#34;&#34;Closing &#39;Select Input&#39; window, clicking &#39;Close&#39; button.&#34;&#34;&#34;
        self.top1.destroy()

    def submit(self, *args):
        &#34;&#34;&#34;Submit the value of start and end times for plotting with the date.&#34;&#34;&#34;
        self.Times_range = []
        self.start_time_plotting = self.start_date_var.get()
        self.end_time_plotting = self.end_date_var.get()
        print(&#39;Start time: &#39; + self.start_time_plotting)
        print(&#39;End time: &#39; + self.end_time_plotting)

        # Updating new text
        self.textStart = self.start_time_plotting
        self.textEnd = self.end_time_plotting

        # Creation of value of editInterval_times
        self.Times_range.append(self.start_time_plotting)
        self.Times_range.append(self.end_time_plotting)

    def checked(self):
        &#34;&#34;&#34; &#39;Set From&#39; button activation.
        Allows user to select between two distinct values (e.g. on/off).&#34;&#34;&#34;
        if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
            self.SetFromButton[&#39;state&#39;] = &#39;normal&#39;
            self.StartButton[&#39;state&#39;] = &#39;normal&#39;
            self.EndButton[&#39;state&#39;] = &#39;normal&#39;

            self.textStart[&#39;state&#39;] = &#39;normal&#39;
            self.textEnd[&#39;state&#39;] = &#39;normal&#39;

            # Delete content from position 0 to end
            self.textStart.delete(0, &#39;end&#39;)
            self.textEnd.delete(0, &#39;end&#39;)

            # Insert new_text at position 0
            self.textStart.insert(0, self.time_summarize[1])
            self.textEnd.insert(0, self.time_summarize[2])

        else:
            self.SetFromButton[&#39;state&#39;] = &#39;disabled&#39;
            self.StartButton[&#39;state&#39;] = &#39;disabled&#39;
            self.EndButton[&#39;state&#39;] = &#39;disabled&#39;

            self.textStart[&#39;state&#39;] = &#39;disabled&#39;
            self.textEnd[&#39;state&#39;] = &#39;disabled&#39;

    # ==================== Calling for plotting.py ====================

    def show_plot(self, e):
        &#34;&#34;&#34;Calls the class to plot Spectrum, Time profile, Spectrogram.
        Parameters are taken from .fits file, chosen(loaded) by user.&#34;&#34;&#34;

        # If entire file:
        if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
            plots = plotting.Input(self.name)
        # If not entire file:
        elif self.SetFromButton[&#39;state&#39;] == &#39;normal&#39;:
            self.submit()
            plots = plotting.Input(self.name, self.Times_range[0], self.Times_range[1], self.time_summarize[1])
        else:
            plots = None
            print(&#39;Error&#39;)

        if self.var.get() == &#39;Rate&#39;:
            if e == &#39;time&#39;:
                plots.rate_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_rate()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_rate()

        if self.var.get() == &#39;Counts&#39;:
            if e == &#39;time&#39;:
                plots.counts_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_counts()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_counts()

        if self.var.get() == &#39;Flux&#39;:
            if e == &#39;time&#39;:
                plots.flux_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_flux()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_flux()</code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-classes">Classes</h2>
<dl>
<dt id="second.SecondWindow"><code class="flex name class">
<span>class <span class="ident">SecondWindow</span></span>
<span>(</span><span>root)</span>
</code></dt>
<dd>
<div class="desc"><p>Class to create "Select Input Window" menu option in STIX.
Rout: Go to top menu bars -&gt; File -&gt; Select Input.
Initiates the parameters and widgets</p>
<p>Creating a new window for 'Select Input' part, using the 'place' geometry manager, allowing to explicitly
set the position and dimensions of window. The place manager can be accessed through the place method.
It can be applied to all standard widgets.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">class SecondWindow:
    &#34;&#34;&#34;Class to create &#34;Select Input Window&#34; menu option in STIX.
    Rout: Go to top menu bars -&gt; File -&gt; Select Input.
    Initiates the parameters and widgets&#34;&#34;&#34;

    def __init__(self, root):
        &#34;&#34;&#34;Creating a new window for &#39;Select Input&#39; part, using the &#39;place&#39; geometry manager, allowing to explicitly
        set the position and dimensions of window. The place manager can be accessed through the place method.
        It can be applied to all standard widgets.&#34;&#34;&#34;
        self.top1 = Toplevel()
        self.top1.title(&#39;STIX Input Options&#39;)
        self.top1.geometry(&#34;1000x400&#34;)
        Label(self.top1, text=&#34;Select Input&#34;, fg=&#34;red&#34;, font=&#34;Helvetica 12 bold italic&#34;).place(relx=0.5, rely=0.01,
                                                                                               anchor=N)
        # Creates a window to inform user hdul is empty
        self.hdul = None
        self.root = root

        # &#39;Select input&#39; window should contain 2 frames:
        # 1) Widgets to load the data, read the content of .fits file extensions, etc;
        # 2) Widgets to  select the energy bands and time bands intervals, and plot.

        # ==================== First frame and additional widgets ====================

        # The name of the widget is in the &#39;text&#39; parameter
        self.frame1 = LabelFrame(self.top1, relief=RAISED, borderwidth=1)
        self.frame1.place(relx=0.5, rely=0.08, relheight=0.60, relwidth=0.9, anchor=N)

        self.name = None

        self.lblFilename = Label(self.frame1, text=&#34;Spectrum or Image File: &#34;)
        self.lblFilename.place(relx=0.01, rely=0.2)

        self.textFilename = Entry(self.frame1, width=20)
        self.textFilename.insert(0, &#34;No file chosen&#34;)
        self.textFilename.place(relx=0.2, rely=0.18, relheight=0.16, relwidth=0.57)

        self.browseButton = Button(self.frame1, text=&#39;Browse -&gt;&#39;, command=self.OpenFile)
        self.browseButton.place(relx=0.8, rely=0.186)

        self.chkBtEntireFile = Checkbutton(self.frame1, text=&#34;Entire file&#34;, command=self.checked)
        self.chkBtEntireFile.place(relx=0.03, rely=0.37)
        self.chkBtEntireFile.select()

        # Open file
        self.evt_data = Table()
        self.energies = Table()
        self.data_file = None
        self.time_summarize = Table()
        self.energie_summarize = Table()
        self.detector_summarize = Table()

        # Select Start data and End data for plotting if different of file&#39;s information(start-end)
        self.SetFromButton = Label(self.frame1, text=&#34;Set from -&gt; &#34;, state=DISABLED)
        self.SetFromButton.place(relx=0.1, rely=0.55)

        # Change Button to Label and insert the date data
        self.Times_range = []  # value for Times ranges

        self.start_date_var = StringVar()
        self.end_date_var = StringVar()
        self.start_time_plotting = StringVar()
        self.end_time_plotting = StringVar()

        self.StartButton = Label(self.frame1, text=&#34;Start&#34;, state=DISABLED)
        self.StartButton.place(relx=0.24, rely=0.55)

        self.textStart = Entry(self.frame1, textvariable=self.start_date_var, width=20)
        self.textStart.place(relx=0.31, rely=0.55, height=33, width=190)
        self.textStart[&#39;state&#39;] = &#39;disabled&#39;

        self.EndButton = Label(self.frame1, text=&#34;End&#34;, state=DISABLED)
        self.EndButton.place(relx=0.53, rely=0.55)

        self.textEnd = Entry(self.frame1, textvariable=self.end_date_var, width=20)
        self.textEnd.place(relx=0.59, rely=0.55, height=33, width=190)
        self.textEnd[&#39;state&#39;] = &#39;disabled&#39;

        # &#34;Summarize&#34; button. When clicked, creates a new window with the name &#34;SPEX::PREVIEW,
        # then gives information from self.hdul[1].header.
        self.SummarizeButton = Button(self.frame1, text=&#34;Summarize&#34;, command=self.Summarize)
        self.SummarizeButton.place(relx=0.45, rely=0.81, anchor=NE)

        # &#34;Show Header&#34; button. When clicked, gives the information from primary_header = hdulist[0].header.
        self.ShowHeaderButton = Button(self.frame1, text=&#34;Show Header&#34;, command=self.ShowHeader)
        self.ShowHeaderButton.place(relx=0.55, rely=0.81, anchor=NW)

        self.header_primary = None

        self.frame2 = LabelFrame(self.top1, relief=RAISED, borderwidth=2)

        # ==================== Second frame and plotting section ====================

        self.frame2.place(relx=0.5, rely=0.7, relheight=0.15, relwidth=0.9, anchor=N)

        # Plot Units for Rate, Counts, and Flux
        self.lblPlotUnits = Label(self.frame2, text=&#34;Plot Units: &#34;)
        self.lblPlotUnits.place(relx=0.013, rely=0.5, anchor=W)

        # Option menu for Rate, Counts, Flux
        self.Component_choices = (&#39;Rate&#39;, &#39;Counts&#39;, &#39;Flux&#39;)
        self.var = StringVar(self.frame1)
        self.var.set(self.Component_choices[0])
        self.selection = OptionMenu(self.frame2, self.var, *self.Component_choices)
        self.selection.place(relx=0.11, rely=0.5, anchor=W)

        self.PlotSpectrumButton = Button(self.frame2, text=&#34;Plot Spectrum&#34;,
                                         command=lambda: self.show_plot(&#34;spec&#34;))
        self.PlotSpectrumButton.place(relx=0.31, rely=0.5, anchor=W)

        self.PlotTimeProfileButton = Button(self.frame2, text=&#34;Plot Time Profile&#34;,
                                            command=lambda: self.show_plot(&#34;time&#34;))
        self.PlotTimeProfileButton.place(relx=0.457, rely=0.5, anchor=W)

        self.PlotSpectrogramButton = Button(self.frame2, text=&#34;Plot Spectrogram&#34;,
                                            command=lambda: self.show_plot(&#34;specgr&#34;))
        self.PlotSpectrogramButton.place(relx=0.62, rely=0.5, anchor=W)

        self.closeButton = Button(self.top1, text=&#34;Close&#34;, command=self.destroy)
        self.closeButton.place(relx=0.5, rely=0.9, anchor=N)

    # ============================ Main methods ============================

    def OpenFile(self):
        &#34;&#34;&#34;Reads the input data using Astropy library. It can be any extension. RHESSI .fits files are analysed.&#34;&#34;&#34;
        self.name = askopenfilename(initialdir=&#34;.&#34;,
                                    filetypes=((&#34;FITS files&#34;, &#34;*.fits&#34;), (&#34;All Files&#34;, &#34;*.*&#34;)),
                                    title=&#34;Please Select Spectrum or Image File&#34;)
        self.textFilename.delete(0, &#39;end&#39;)
        background.BackgroundWindow.fname = self.name

        if self.name:
            with fits.open(self.name) as hdul:
                self.hdul = hdul

                # Loads data to do the plot
                self.evt_data = Table(self.hdul[2].data)
                self.energies = Table(self.hdul[3].data)

                # Loads headers informations
                self.data_file = self.hdul[0].header[5]  # data type
                self.time_summarize = [self.hdul[2].data.time[-1], self.hdul[0].header[19],
                                       self.hdul[0].header[21]]  # time data
                self.energie_summarize = [self.hdul[3].header[4],
                                          max(min(self.energies[&#39;e_low&#39;]), min(self.energies[&#39;e_high&#39;])),
                                          min(max(self.energies[&#39;e_low&#39;]),
                                              max(self.energies[&#39;e_high&#39;]))]  # energies data
                self.detector_summarize = [&#34;No information found.&#34;]
                self.textFilename.insert(0, self.name)  # Displays the input file name in Entry box
        else:
            self.textFilename.insert(0, &#34;No file chosen&#34;)

    def Summarize(self):
        &#34;&#34;&#34;Creating a new window for Summarize button.
        Reads the information from Header and Data and display it in new window&#34;&#34;&#34;
        top = Toplevel()
        top.title(&#39;SPEX::PREVIEW&#39;)
        top.geometry(&#34;400x300&#34;)
        frameSummarize = LabelFrame(top, relief=RAISED, borderwidth=2)
        frameSummarize.pack(side=TOP, expand=True)

        txt = [&#34;\n\n\nSpectrum or Image File Summary&#34;,
               &#34;\nData Type: &#34;, self.data_file,
               &#34;\nFile name: &#34;, self.name,
               &#34;\n#Time Bins: &#34;, self.time_summarize[0], &#34;Time range: &#34;, self.time_summarize[1], &#39;to&#39;,
               self.time_summarize[2],
               &#34;\n#Energy Bins: &#34;, self.energie_summarize[0],
               &#34;Energy range: &#34;, self.energie_summarize[1], &#39;to&#39;, self.energie_summarize[2],
               &#34;\nDetectors Used: &#34;, self.detector_summarize[0],
               &#34;\nResponse Info: &#34;, self.name]
        liste = Text(frameSummarize)
        for t in txt:
            liste.insert(END, t)
        liste.pack()

    # FIXME: Text should be well-organized in the window &#39;SPEX::FITSHEADER&#39;
    def ShowHeader(self):
        &#34;&#34;&#34;Reads text information from header and display it in new window.&#34;&#34;&#34;
        self.header_primary = self.hdul[0].header
        top = Toplevel()
        top.title(&#39;SPEX::FITSHEADER&#39;)
        top.geometry(&#34;500x700&#34;)
        scrollbar1 = Scrollbar(top)
        scrollbar1.pack(side=RIGHT, fill=Y)
        header = Text(top, width=450, height=450)

        for i in range(len(self.header_primary.cards)):
            header.insert(INSERT, self.header_primary.cards[i])
            header.insert(INSERT, &#34;\n&#34;)

        header.insert(END, &#34;Fin&#34;)
        header.config(state=DISABLED)
        header.pack()
        scrollbar1.config(command=header.yview)

    def destroy(self):
        &#34;&#34;&#34;Closing &#39;Select Input&#39; window, clicking &#39;Close&#39; button.&#34;&#34;&#34;
        self.top1.destroy()

    def submit(self, *args):
        &#34;&#34;&#34;Submit the value of start and end times for plotting with the date.&#34;&#34;&#34;
        self.Times_range = []
        self.start_time_plotting = self.start_date_var.get()
        self.end_time_plotting = self.end_date_var.get()
        print(&#39;Start time: &#39; + self.start_time_plotting)
        print(&#39;End time: &#39; + self.end_time_plotting)

        # Updating new text
        self.textStart = self.start_time_plotting
        self.textEnd = self.end_time_plotting

        # Creation of value of editInterval_times
        self.Times_range.append(self.start_time_plotting)
        self.Times_range.append(self.end_time_plotting)

    def checked(self):
        &#34;&#34;&#34; &#39;Set From&#39; button activation.
        Allows user to select between two distinct values (e.g. on/off).&#34;&#34;&#34;
        if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
            self.SetFromButton[&#39;state&#39;] = &#39;normal&#39;
            self.StartButton[&#39;state&#39;] = &#39;normal&#39;
            self.EndButton[&#39;state&#39;] = &#39;normal&#39;

            self.textStart[&#39;state&#39;] = &#39;normal&#39;
            self.textEnd[&#39;state&#39;] = &#39;normal&#39;

            # Delete content from position 0 to end
            self.textStart.delete(0, &#39;end&#39;)
            self.textEnd.delete(0, &#39;end&#39;)

            # Insert new_text at position 0
            self.textStart.insert(0, self.time_summarize[1])
            self.textEnd.insert(0, self.time_summarize[2])

        else:
            self.SetFromButton[&#39;state&#39;] = &#39;disabled&#39;
            self.StartButton[&#39;state&#39;] = &#39;disabled&#39;
            self.EndButton[&#39;state&#39;] = &#39;disabled&#39;

            self.textStart[&#39;state&#39;] = &#39;disabled&#39;
            self.textEnd[&#39;state&#39;] = &#39;disabled&#39;

    # ==================== Calling for plotting.py ====================

    def show_plot(self, e):
        &#34;&#34;&#34;Calls the class to plot Spectrum, Time profile, Spectrogram.
        Parameters are taken from .fits file, chosen(loaded) by user.&#34;&#34;&#34;

        # If entire file:
        if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
            plots = plotting.Input(self.name)
        # If not entire file:
        elif self.SetFromButton[&#39;state&#39;] == &#39;normal&#39;:
            self.submit()
            plots = plotting.Input(self.name, self.Times_range[0], self.Times_range[1], self.time_summarize[1])
        else:
            plots = None
            print(&#39;Error&#39;)

        if self.var.get() == &#39;Rate&#39;:
            if e == &#39;time&#39;:
                plots.rate_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_rate()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_rate()

        if self.var.get() == &#39;Counts&#39;:
            if e == &#39;time&#39;:
                plots.counts_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_counts()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_counts()

        if self.var.get() == &#39;Flux&#39;:
            if e == &#39;time&#39;:
                plots.flux_vs_time_plotting()
            elif e == &#39;spec&#39;:
                plots.plot_spectrum_flux()
            elif e == &#39;specgr&#39;:
                plots.plot_spectrogram_flux()</code></pre>
</details>
<h3>Methods</h3>
<dl>
<dt id="second.SecondWindow.OpenFile"><code class="name flex">
<span>def <span class="ident">OpenFile</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Reads the input data using Astropy library. It can be any extension. RHESSI .fits files are analysed.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def OpenFile(self):
    &#34;&#34;&#34;Reads the input data using Astropy library. It can be any extension. RHESSI .fits files are analysed.&#34;&#34;&#34;
    self.name = askopenfilename(initialdir=&#34;.&#34;,
                                filetypes=((&#34;FITS files&#34;, &#34;*.fits&#34;), (&#34;All Files&#34;, &#34;*.*&#34;)),
                                title=&#34;Please Select Spectrum or Image File&#34;)
    self.textFilename.delete(0, &#39;end&#39;)
    background.BackgroundWindow.fname = self.name

    if self.name:
        with fits.open(self.name) as hdul:
            self.hdul = hdul

            # Loads data to do the plot
            self.evt_data = Table(self.hdul[2].data)
            self.energies = Table(self.hdul[3].data)

            # Loads headers informations
            self.data_file = self.hdul[0].header[5]  # data type
            self.time_summarize = [self.hdul[2].data.time[-1], self.hdul[0].header[19],
                                   self.hdul[0].header[21]]  # time data
            self.energie_summarize = [self.hdul[3].header[4],
                                      max(min(self.energies[&#39;e_low&#39;]), min(self.energies[&#39;e_high&#39;])),
                                      min(max(self.energies[&#39;e_low&#39;]),
                                          max(self.energies[&#39;e_high&#39;]))]  # energies data
            self.detector_summarize = [&#34;No information found.&#34;]
            self.textFilename.insert(0, self.name)  # Displays the input file name in Entry box
    else:
        self.textFilename.insert(0, &#34;No file chosen&#34;)</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.ShowHeader"><code class="name flex">
<span>def <span class="ident">ShowHeader</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Reads text information from header and display it in new window.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def ShowHeader(self):
    &#34;&#34;&#34;Reads text information from header and display it in new window.&#34;&#34;&#34;
    self.header_primary = self.hdul[0].header
    top = Toplevel()
    top.title(&#39;SPEX::FITSHEADER&#39;)
    top.geometry(&#34;500x700&#34;)
    scrollbar1 = Scrollbar(top)
    scrollbar1.pack(side=RIGHT, fill=Y)
    header = Text(top, width=450, height=450)

    for i in range(len(self.header_primary.cards)):
        header.insert(INSERT, self.header_primary.cards[i])
        header.insert(INSERT, &#34;\n&#34;)

    header.insert(END, &#34;Fin&#34;)
    header.config(state=DISABLED)
    header.pack()
    scrollbar1.config(command=header.yview)</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.Summarize"><code class="name flex">
<span>def <span class="ident">Summarize</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Creating a new window for Summarize button.
Reads the information from Header and Data and display it in new window</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def Summarize(self):
    &#34;&#34;&#34;Creating a new window for Summarize button.
    Reads the information from Header and Data and display it in new window&#34;&#34;&#34;
    top = Toplevel()
    top.title(&#39;SPEX::PREVIEW&#39;)
    top.geometry(&#34;400x300&#34;)
    frameSummarize = LabelFrame(top, relief=RAISED, borderwidth=2)
    frameSummarize.pack(side=TOP, expand=True)

    txt = [&#34;\n\n\nSpectrum or Image File Summary&#34;,
           &#34;\nData Type: &#34;, self.data_file,
           &#34;\nFile name: &#34;, self.name,
           &#34;\n#Time Bins: &#34;, self.time_summarize[0], &#34;Time range: &#34;, self.time_summarize[1], &#39;to&#39;,
           self.time_summarize[2],
           &#34;\n#Energy Bins: &#34;, self.energie_summarize[0],
           &#34;Energy range: &#34;, self.energie_summarize[1], &#39;to&#39;, self.energie_summarize[2],
           &#34;\nDetectors Used: &#34;, self.detector_summarize[0],
           &#34;\nResponse Info: &#34;, self.name]
    liste = Text(frameSummarize)
    for t in txt:
        liste.insert(END, t)
    liste.pack()</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.checked"><code class="name flex">
<span>def <span class="ident">checked</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>'Set From' button activation.
Allows user to select between two distinct values (e.g. on/off).</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def checked(self):
    &#34;&#34;&#34; &#39;Set From&#39; button activation.
    Allows user to select between two distinct values (e.g. on/off).&#34;&#34;&#34;
    if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
        self.SetFromButton[&#39;state&#39;] = &#39;normal&#39;
        self.StartButton[&#39;state&#39;] = &#39;normal&#39;
        self.EndButton[&#39;state&#39;] = &#39;normal&#39;

        self.textStart[&#39;state&#39;] = &#39;normal&#39;
        self.textEnd[&#39;state&#39;] = &#39;normal&#39;

        # Delete content from position 0 to end
        self.textStart.delete(0, &#39;end&#39;)
        self.textEnd.delete(0, &#39;end&#39;)

        # Insert new_text at position 0
        self.textStart.insert(0, self.time_summarize[1])
        self.textEnd.insert(0, self.time_summarize[2])

    else:
        self.SetFromButton[&#39;state&#39;] = &#39;disabled&#39;
        self.StartButton[&#39;state&#39;] = &#39;disabled&#39;
        self.EndButton[&#39;state&#39;] = &#39;disabled&#39;

        self.textStart[&#39;state&#39;] = &#39;disabled&#39;
        self.textEnd[&#39;state&#39;] = &#39;disabled&#39;</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.destroy"><code class="name flex">
<span>def <span class="ident">destroy</span></span>(<span>self)</span>
</code></dt>
<dd>
<div class="desc"><p>Closing 'Select Input' window, clicking 'Close' button.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def destroy(self):
    &#34;&#34;&#34;Closing &#39;Select Input&#39; window, clicking &#39;Close&#39; button.&#34;&#34;&#34;
    self.top1.destroy()</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.show_plot"><code class="name flex">
<span>def <span class="ident">show_plot</span></span>(<span>self, e)</span>
</code></dt>
<dd>
<div class="desc"><p>Calls the class to plot Spectrum, Time profile, Spectrogram.
Parameters are taken from .fits file, chosen(loaded) by user.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def show_plot(self, e):
    &#34;&#34;&#34;Calls the class to plot Spectrum, Time profile, Spectrogram.
    Parameters are taken from .fits file, chosen(loaded) by user.&#34;&#34;&#34;

    # If entire file:
    if self.SetFromButton[&#39;state&#39;] == &#39;disabled&#39;:
        plots = plotting.Input(self.name)
    # If not entire file:
    elif self.SetFromButton[&#39;state&#39;] == &#39;normal&#39;:
        self.submit()
        plots = plotting.Input(self.name, self.Times_range[0], self.Times_range[1], self.time_summarize[1])
    else:
        plots = None
        print(&#39;Error&#39;)

    if self.var.get() == &#39;Rate&#39;:
        if e == &#39;time&#39;:
            plots.rate_vs_time_plotting()
        elif e == &#39;spec&#39;:
            plots.plot_spectrum_rate()
        elif e == &#39;specgr&#39;:
            plots.plot_spectrogram_rate()

    if self.var.get() == &#39;Counts&#39;:
        if e == &#39;time&#39;:
            plots.counts_vs_time_plotting()
        elif e == &#39;spec&#39;:
            plots.plot_spectrum_counts()
        elif e == &#39;specgr&#39;:
            plots.plot_spectrogram_counts()

    if self.var.get() == &#39;Flux&#39;:
        if e == &#39;time&#39;:
            plots.flux_vs_time_plotting()
        elif e == &#39;spec&#39;:
            plots.plot_spectrum_flux()
        elif e == &#39;specgr&#39;:
            plots.plot_spectrogram_flux()</code></pre>
</details>
</dd>
<dt id="second.SecondWindow.submit"><code class="name flex">
<span>def <span class="ident">submit</span></span>(<span>self, *args)</span>
</code></dt>
<dd>
<div class="desc"><p>Submit the value of start and end times for plotting with the date.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def submit(self, *args):
    &#34;&#34;&#34;Submit the value of start and end times for plotting with the date.&#34;&#34;&#34;
    self.Times_range = []
    self.start_time_plotting = self.start_date_var.get()
    self.end_time_plotting = self.end_date_var.get()
    print(&#39;Start time: &#39; + self.start_time_plotting)
    print(&#39;End time: &#39; + self.end_time_plotting)

    # Updating new text
    self.textStart = self.start_time_plotting
    self.textEnd = self.end_time_plotting

    # Creation of value of editInterval_times
    self.Times_range.append(self.start_time_plotting)
    self.Times_range.append(self.end_time_plotting)</code></pre>
</details>
</dd>
</dl>
</dd>
</dl>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-classes">Classes</a></h3>
<ul>
<li>
<h4><code><a title="second.SecondWindow" href="#second.SecondWindow">SecondWindow</a></code></h4>
<ul class="two-column">
<li><code><a title="second.SecondWindow.OpenFile" href="#second.SecondWindow.OpenFile">OpenFile</a></code></li>
<li><code><a title="second.SecondWindow.ShowHeader" href="#second.SecondWindow.ShowHeader">ShowHeader</a></code></li>
<li><code><a title="second.SecondWindow.Summarize" href="#second.SecondWindow.Summarize">Summarize</a></code></li>
<li><code><a title="second.SecondWindow.checked" href="#second.SecondWindow.checked">checked</a></code></li>
<li><code><a title="second.SecondWindow.destroy" href="#second.SecondWindow.destroy">destroy</a></code></li>
<li><code><a title="second.SecondWindow.show_plot" href="#second.SecondWindow.show_plot">show_plot</a></code></li>
<li><code><a title="second.SecondWindow.submit" href="#second.SecondWindow.submit">submit</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>